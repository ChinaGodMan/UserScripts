// ==UserScript==
// @name       ChatGPT Character Counter Limit (CCCL)
// @description  Adds a character counter to the input field with a limit of 32732 characters. (ChatGPT has a limit of 32732 characters.)
// @name:zh-CN      ChatGPT 字符计数器限制 (CCCL)
// @description:zh-CN 添加一个字符计数器到输入框，限制为 32732 个字符。（ChatGPT 的限制是 32732 个字符。）
// @name:ar      ChatGPT حد عداد الأحرف (CCCL)
// @description:ar إضافة عداد الأحرف إلى مربع الإدخال，يقتصر على 32732 الشخصيات。（ChatGPT الحد هو 32732 الشخصيات。）
// @name:bg      ChatGPT Ограничение на брояча на знаци (CCCL)
// @description:bg Добавете брояч на символи към полето за въвеждане，ограничен до 32732 герои。（ChatGPT Ограничението е 32732 герои。）
// @name:cs      ChatGPT Limit počítadla znaků (CCCL)
// @description:cs Do vstupního pole přidejte počítadlo znaků，omezena na 32732 postavy。（ChatGPT Limit je 32732 postavy。）
// @name:da      ChatGPT Tegntællergrænse (CCCL)
// @description:da Tilføj en tegntæller til inputfeltet，begrænset til 32732 tegn。（ChatGPT Grænsen er 32732 tegn。）
// @name:de      ChatGPT Zeichenzählerlimit (CCCL)
// @description:de Fügen Sie dem Eingabefeld einen Zeichenzähler hinzu，beschränkt auf 32732 Charaktere。（ChatGPT Die Grenze ist 32732 Charaktere。）
// @name:el      ChatGPT Όριο μετρητή χαρακτήρων (CCCL)
// @description:el Προσθέστε έναν μετρητή χαρακτήρων στο πλαίσιο εισαγωγής，περιορίζεται σε 32732 χαρακτήρες。（ChatGPT Το όριο είναι 32732 χαρακτήρες。）
// @name:en      ChatGPT Character counter limit (CCCL)
// @description:en Add a character counter to the input box，limited to 32732 characters。（ChatGPT The limit is 32732 characters。）
// @name:eo      ChatGPT Limo de nombrilo de karakteroj (CCCL)
// @description:eo Aldonu signan nombrilon al la eniga skatolo，limigita al 32732 karakteroj。（ChatGPT La limo estas 32732 karakteroj。）
// @name:es      ChatGPT Límite del contador de caracteres (CCCL)
// @description:es Agregue un contador de caracteres al cuadro de entrada，circunscrito a 32732 personajes。（ChatGPT El límite es 32732 personajes。）
// @name:fi      ChatGPT Merkkilaskurin raja (CCCL)
// @description:fi Lisää merkkilaskuri syöttöruutuun，rajoitettu 32732 hahmoja。（ChatGPT Raja on 32732 hahmoja。）
// @name:fr      ChatGPT Limite du compteur de caractères (CCCL)
// @description:fr Ajouter un compteur de caractères à la zone de saisie，limité à 32732 personnages。（ChatGPT La limite est 32732 personnages。）
// @name:he      ChatGPT מגבלת מונה תווים (CCCL)
// @description:he הוסף מונה תווים לתיבת הקלט，מוגבל ל 32732 תווים。（ChatGPT הגבול הוא 32732 תווים。）
// @name:hr      ChatGPT Ograničenje brojača znakova (CCCL)
// @description:hr Dodajte brojač znakova u polje za unos，ograničeno na 32732 likovi。（ChatGPT Granica je 32732 likovi。）
// @name:hu      ChatGPT Karakterszámláló korlát (CCCL)
// @description:hu Adjon hozzá egy karakterszámlálót a beviteli mezőhöz，korlátozva 32732 karakterek。（ChatGPT A határ az 32732 karakterek。）
// @name:id      ChatGPT Batas penghitung karakter (CCCL)
// @description:id Tambahkan penghitung karakter ke kotak input，terbatas pada 32732 karakter。（ChatGPT Batasnya adalah 32732 karakter。）
// @name:it      ChatGPT Limite del contatore di caratteri (CCCL)
// @description:it Aggiungi un contatore di caratteri alla casella di input，limitato a 32732 caratteri。（ChatGPT Il limite è 32732 caratteri。）
// @name:ja      ChatGPT 文字数カウンターの制限 (CCCL)
// @description:ja 入力ボックスに文字カウンターを追加する，に限定される 32732 キャラクター。（ChatGPT 限界は 32732 キャラクター。）
// @name:ka      ChatGPT სიმბოლოების მრიცხველის ლიმიტი (CCCL)
// @description:ka დაამატეთ სიმბოლოების მრიცხველი შეყვანის ველში，შემოიფარგლება 32732 პერსონაჟები。（ChatGPT ლიმიტი არის 32732 პერსონაჟები。）
// @name:ko      ChatGPT 문자 카운터 제한 (CCCL)
// @description:ko 입력 상자에 문자 카운터 추가，로 제한됨 32732 문자。（ChatGPT 한도는 32732 문자。）
// @name:nl      ChatGPT Limiet voor tekenteller (CCCL)
// @description:nl Voeg een tekenteller toe aan het invoervak，beperkt tot 32732 karakters。（ChatGPT De limiet is 32732 karakters。）
// @name:nb      ChatGPT Tegntellergrense (CCCL)
// @description:nb Legg til en tegnteller i inndataboksen，begrenset til 32732 tegn。（ChatGPT Grensen er 32732 tegn。）
// @name:pl      ChatGPT Limit licznika znaków (CCCL)
// @description:pl Dodaj licznik znaków do pola wprowadzania，ograniczone do 32732 pismo。（ChatGPT Limit jest 32732 pismo。）
// @name:pt-BR      ChatGPT Limite do contador de caracteres (CCCL)
// @description:pt-BR Adicione um contador de caracteres à caixa de entrada，limitado a 32732 personagens。（ChatGPT O limite é 32732 personagens。）
// @name:ro      ChatGPT Limita contorului de caractere (CCCL)
// @description:ro Adăugați un numărător de caractere în caseta de introducere，limitat la 32732 personaje。（ChatGPT Limita este 32732 personaje。）
// @name:ru      ChatGPT Ограничение счетчика символов (CCCL)
// @description:ru Добавьте счетчик символов в поле ввода，ограничено 32732 персонажи。（ChatGPT Предел 32732 персонажи。）
// @name:sk      ChatGPT Limit počítadla znakov (CCCL)
// @description:sk Do vstupného poľa pridajte počítadlo znakov，obmedzené na 32732 postavy。（ChatGPT Limit je 32732 postavy。）
// @name:sr      ChatGPT Ограничење бројача знакова (CCCL)
// @description:sr Додајте бројач знакова у поље за унос，ограничен на 32732 ликова。（ChatGPT Граница је 32732 ликова。）
// @name:sv      ChatGPT Gräns ​​för teckenräknare (CCCL)
// @description:sv Lägg till en teckenräknare i inmatningsrutan，begränsat till 32732 tecken。（ChatGPT Gränsen är 32732 tecken。）
// @name:th      ChatGPT ขีดจำกัดตัวนับอักขระ (CCCL)
// @description:th เพิ่มตัวนับอักขระลงในกล่องอินพุต，จำกัดอยู่ที่ 32732 ตัวอักษร。（ChatGPT ขีดจำกัดคือ 32732 ตัวอักษร。）
// @name:tr      ChatGPT Karakter sayacı sınırı (CCCL)
// @description:tr Giriş kutusuna karakter sayacı ekleme，sınırlı 32732 karakterler。（ChatGPT Sınır 32732 karakterler。）
// @name:ug      ChatGPT ھەرپ-بەلگە چەكلىمىسى (CCCL)
// @description:ug كىرگۈزۈش رامكىسىغا ھەرپ ھېسابلىغۇچ قوشۇڭ，بىلەنلا چەكلىنىدۇ 32732 ھەرپلەر。（ChatGPT چەك 32732 ھەرپلەر。）
// @name:uk      ChatGPT Обмеження лічильника символів (CCCL)
// @description:uk Додайте лічильник символів у поле введення，обмежується 32732 персонажів。（ChatGPT Межа є 32732 персонажів。）
// @name:vi      ChatGPT Giới hạn bộ đếm ký tự (CCCL)
// @description:vi Thêm bộ đếm ký tự vào hộp nhập liệu，giới hạn ở 32732 nhân vật。（ChatGPT Giới hạn là 32732 nhân vật。）
// @name:zh-TW      ChatGPT 字元計數器限制 (CCCL)
// @description:zh-TW 新增一個字元計數器到輸入框，限制為 32732 個字元。（ChatGPT 的限制是 32732 個字元。）
// @name:zh-HK      ChatGPT 字元計數器限制 (CCCL)
// @description:zh-HK 新增一個字元計數器到輸入框，限制為 32732 個字元。（ChatGPT 的限制是 32732 個字元。）
// @name:fr-CA      ChatGPT Limite du compteur de caractères (CCCL)
// @description:fr-CA Ajouter un compteur de caractères à la zone de saisie，limité à 32732 personnages。（ChatGPT La limite est 32732 personnages。）
// @namespace     https://github.com/ChinaGodMan/UserScripts
// @version 1.3.1.4
// @author       Emree.el on instagram ,人民的勤务员 <toniaiwanowskiskr47@gmail.com>
// @match        https://chatgpt.com/*
// @grant        none
// @license      MIT
// @supportURL              https://github.com/ChinaGodMan/UserScripts/issues
// @homepageURL   https://github.com/ChinaGodMan/UserScripts
// @icon data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAZlBMVEUAAAD///+hoaFoaGhsbGy7u7vd3d2+vr76+vra2tr29va2trYrKyvg4ODs7OxXV1dgYGCtra0xMTGXl5fExMQ6OjqOjo7R0dEVFRWnp6dSUlIiIiIcHBwLCwt4eHhycnKEhIRHR0f14+hfAAADN0lEQVRYhe1WyZajMAyEsMQshgABEwIJ+f+fbC02W0yHnjnNvNYFDFbZKpUlO86v/e/Wpve/8M4TFckwSvI/cx8z11g2/tw9vZKrEIKe159GUkvwipPxVb4eQQzvYV12XX3Y/x6BT5LqUZkgWixEHF/9/hAAeozz0I8nOtzoccDfg8CbaZQrYkOGYUaEFO2RDUTT4MZefjkMpVcQo5/Wr2DSi9/bhlYPhukvZqf41l3hiiFv8xJR2CslIT+XXfc+YapojY60kG1ZA0rknj+lL4YtnGCQ4lbESSczf5R6Ugc5ee4AoL9KAwbwYXDWXJTXhaDhf2L3R44rxzkbgFgHn55Y0JJjzyeONpYLDn4CCPn7A46VaggjwIB6eEltAOConCUAcZVDXBKIHHgbp9IZ4KW0AZj8LAHaQEzaY0lmHk60AXiQ8XYFEDoVrRpXOmSfdQFfbMe7MuTOJMLU6IJqkh7PuTMVrhosAJCp2xrApA6Lk+p4VllMQjsAcNNkpzeQlKkPHhQb0VkAEgO8TSMaVqhMH/EyW57W2R7moNoBCjwDPg1QzM07QAk7o+wUrIcNwAVZ1ktAROE7gBMaEq4kaW8NgHlQOsrULiUoHjGT40PIqngHOIGYzRK22ggJz3TpbrCt7AMU9gPZwc4y5slJC7FO4woAxmcLgMMi0dF1ymSOtnMEYFDczxqtdJRM6HlAbhSvARIqHG+G5BJGqONoK2opooIMLQFaYMvWs0EJruNRV1b8vy+wqDtbEj2caAcQg5NWdIQL6IJPjIGg1gDKhLINARyxed4DpgLFq+vvKoRiEszGWmlCy0OmcyrqSxKr/eaUzFvDGnDWCX2d5zQmNdJsO4xoz8XeyqcpIdRexZ0BBOYl2r2wyHfwB2WFO0zBjS/Zv2Vc8Pey3l3kor0iR65Q+61Vr6GmttNSOtxRf+jgvfnW3eFa4CZ+3fb1k1q1uC0D3GmKC2s5zkxKvieqWbKQPvFpfbRnNF+pYn/+3ny6m0zW+9eYDIMxlQsbvKuO3zfrV5fWKMc4GLu6G+m2KY/fNNnu6/vu2drTv7fFjVuOP3dHy5MolJEqrKfvoPXp57vpr/3r9gUxwiW4OiuC3wAAAABJRU5ErkJggg==
// ==/UserScript==
(function () {
    'use strict'
    // Function to add character counter and handle its behavior
    function addCharacterCounter() {
        if (document.querySelector('.gpt-charCounter')) {//存在返回
            return
        }
        let textarea = document.querySelector('#prompt-textarea')
        if (textarea) {
            let charCounter = document.createElement('div')
            charCounter.className = 'gpt-charCounter'
            charCounter.style.fontSize = '14px'
            charCounter.style.fontWeight = 'bold'
            charCounter.style.marginTop = '5px'
            charCounter.style.color = 'white'
            charCounter.style.textShadow = '0px 0px 5px white' // Default text shadow
            charCounter.textContent = '0/32732'
            textarea.parentElement.appendChild(charCounter)
            function updateCounter() {
                let charCount = textarea.value.length
                charCounter.textContent = `${charCount}/32732`
                if (charCount > 32732) {
                    charCounter.style.color = 'white'
                    charCounter.style.textShadow = '0px 0px 8px red'
                } else if (charCount > 0) {
                    charCounter.style.color = 'white'
                    charCounter.style.textShadow = '0px 0px 8px green'
                } else {
                    charCounter.style.color = 'white'
                    charCounter.style.textShadow = '0px 0px 5px white'
                }
            }
            textarea.addEventListener('input', function () {
                updateCounter()
            })
            document.querySelector('body').addEventListener('click', function (event) {
                const button = event.target.closest('button[data-testid="send-button"]')
                if (button) updateCounter()
            })
        }
    }
    let lastUrl = location.href
    new MutationObserver(() => {
        const url = location.href
        if (url !== lastUrl) {
            lastUrl = url
            addCharacterCounter()
            console.log("change", url)
        }
    }).observe(document, { subtree: true, childList: true })
    // Run the function after the page loads
    window.addEventListener('load', addCharacterCounter)
})()
